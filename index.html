
<!DOCTYPE html><html>
<head>
    <meta charset="UTF-8" />
    <link rel="icon" href="./html/images/favicon.ico" type="image/x-icon" />
    <style>
        /* === Global styles === */
        body {
          margin: 0;
          padding: 0;
          background-color: #000;
          display: flex;
          flex-direction: row;
          justify-content: flex-start;
          align-items: flex-start;
          font-family: Arial, sans-serif;
          gap: 10px;
          flex-wrap: wrap;
        }

        @font-face {
          font-family: 'RDOFont';
          src: url('./Fonts/RDO_chinese_rocks_rg.otf') format('opentype');
          font-weight: normal;
          font-style: normal;
        }
        @font-face {
          font-family: 'hapna';
          src: url('./Fonts/hapna.woff2') format('woff2');
          font-weight: normal;
          font-style: normal;
        }

        /* === Layout containers === */
        .page-container {
          display: flex;
          flex-direction: column;
          min-height: 100vh;
        }
        .main-container {
          display: flex;
          flex-wrap: wrap;
          justify-content: flex-start;
          align-items: flex-start;
          gap: 10px;
          margin: 0;
          padding: 0;
        }

        .left-column {
          display: flex;
          flex-direction: column;
          max-width: 850px;
          width: 100%;
        }

        .sidebar-container {
          display: block;
          width: 450px;
          background-color: #111;
          color: #eee;
          /*border: 2px solid orange;*/
          padding: 15px;
          box-sizing: border-box;
          font-family: Arial, sans-serif;
          overflow: visible; /* allow images to stick outside */
          /* margin-left: -10px;shift left */
        }
        
        
        /* COLUMN 3: BONUS INFO - Fixed to 250px wide */
        .bonus-container {
            padding: 7px;
            background-color: #111; / *Dark grey background */
            display: flex;
            flex-direction: column;
            /* --- FIXED WIDTH CHANGES --- */
            width: 250px; 
            min-width: 250px; 
            max-width: 850px;
            #flex-shrink: 0; /* Ensures this column doesn't shrink, prioritizing the fixed width */
            /* --------------------------- */
        }
        

        .stats-heading {
            font-family: 'RDOFont', sans-serif;
            font-size: 1.3rem;
            margin-top: 0;
            margin-bottom: 5px;
            border-bottom: 2px solid #555;
            padding-bottom: 5px;
            color: #666666; /* PRESERVED: Keeping the original color */
            
        }
        
        .stats-text {
            font-family: 'hapna', sans-serif; /* Example font */
            font-size: .9rem;
            color: #aaa;
            white-space: pre-wrap; /* allows 
 line breaks in descriptions */
            /* REMOVED: transform: scaleX(.85); */
            /* REMOVED: transform-origin: left; */
            
            /* NEW: Use negative letter-spacing to visually condense the text. */
            letter-spacing: -0.05em; 
            
            margin-top: 0;
            margin: 0;
        }

            
            


        .banner-container {
          position: sticky;
          top: 0;
          z-index: 10; /* stays above other content */
          
          
          width: 100%;
          max-width: 850px;
          min-width: 400px;
          background-color: #000;
          /*border: 2px solid blue;*/
          box-sizing: border-box;
          padding: 10px;
          color: #eee;
        }

        .banner-image-wrapper {
          position: relative;
          width: 100%;
        }

        .banner-image {
          width: 100%;
          height: auto;
          display: block;
        }

        .banner-text-overlay {
          position: absolute;
          top: -3%;
          left: 50%;
          transform: translateX(-50%);
          color: white;
          text-align: center;
          width: 90%;
          text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
          pointer-events: none;
          font-family: 'RDOFont', sans-serif;
        }

        .banner-title {
          font-size: 2.5rem;
          margin: 10px 0;
          text-shadow:
            -2px -2px 0 #000,
             2px -2px 0 #000,
            -2px  2px 0 #000,
             2px  2px 0 #000;
        }

        .banner-date {
          font-size: 1.4rem;
          margin-bottom: 10px;
          margin-top: -15px;
          text-shadow:
           -1px -1px 2px #000,
            1px -1px 2px #000,
           -1px  1px 2px #000,
            1px  1px 2px #000;
        }

        .challenge-counters {
          position: absolute;
          bottom: 10px;
          left: 0;
          right: 0;
          display: flex;
          justify-content: space-between;
          padding: 0 15px;
          font-size: 1.25rem;
          color: white;
          text-shadow: 3px 3px 2px rgba(0,0,0,0.6);
          pointer-events: none;
          font-family: 'RDOFont', sans-serif;
          transform: scaleY(1.15); /* Increase font height */
          
        }

        .challenge-counters > div {
          white-space: nowrap;
        }

        .challenge-counters span {
          display: inline-block;
          width: 4ch;
          text-align: right;
        }
        
        .counter-glow {
          color: white;
          text-shadow:
            0 0 5px rgba(255, 255, 160, 0.75),  /* yellow glow with an opacity (0.75) */
            0 0 10px rgba(255, 255, 160, 0.75),
            0 0 15px rgba(255, 255, 160, 0.75);
          transition: text-shadow 0.3s ease;
        }
        
        @keyframes counterPop {
          0% {
            transform: scale(1);
          }
          50% {
            transform: scale(1.3);
          }
          100% {
            transform: scale(1);
          }
        }

        .counter-pop {
          animation: counterPop 0.4s ease forwards;
        }
        
        

        .general-challenges-container {
          width: 100%;
          max-width: 850px;
          margin: 0 auto;
          background-color: #111;
          padding: 15px;
          box-sizing: border-box;
          color: white;
          font-family: 'hapna', sans-serif;
          font-size: 1.25rem;
          text-shadow: 1px 1px 2px rgba(0,0,0,0.6);
          /*border: 2px solid green;*/
        }



/* ############################################################# */
/*  Role challenges switching logic as browser viewport narrows  */
/* ############################################################# */
        
        /* NEW: Rule to hide the bonus container when screen is 1600px or less (The Requirement) */
        @media (max-width: 1600px) {
            .bonus-container {
                display: none; 
          }
        }
        
        
        
        /* Narrow screens: column layout, sidebar below main */
        @media (max-width: 1320px) {
          body {
            flex-direction: column;
            align-items: center;
          }
          
            .main-container {
            flex-direction: column;
            align-items: center;
            width: 100%;    /* allow children to fill horizontally */
            align-items: stretch; /* <— THIS is the key */
            min-width: 420px;
          }
          
          .sidebar-container {
            width: 100% !important; 
            max-width: 850px !important;
            margin-left: 0;    /* center below main container */
          }      
        }

        /* === Challenge checkboxes with wrapped text aligned properly === */
        .challenge label {
          display: flex; /* container */
          align-items: flex-start;  /* Align to the top of the checkbox */
          gap: 8px;                 /* Space between checkbox and text */
          position: relative; /* for absolute checkbox */
          padding-left: 0px; /* reserve space for checkbox */
          cursor: pointer;
          white-space: normal;
          line-height: 1.3;
        }
        
        .challenge:first-of-type label {
          margin-top: -8px; /* adjust as needed */
        }

        /* Position the checkbox at the left of label */
        .challenge-checkbox {
          width: 14px;
          height: 14px;
          margin: 0;
          margin-top: 6px;  /* Optional: better vertical alignment */
          appearance: none; /* Remove default styling */
          -webkit-appearance: none;
          background-color: #888; /* Default background */
          /* background-color: orange; /* TEST */*/
          border: 2px solid #333;
          border-radius: 3px;
          cursor: pointer;
        }
        
        .challenge-checkbox:checked {
          background-color: #222;
          background-color: #b00000;  /* Dark Red Colour */
          border: 2px solid #333;
          border-radius: 3px;
        }
        
        /* add a checkmark */
        .challenge-checkbox:checked::before {
          content: "✔";
          display: block;
          text-align: top;
          color: white;
          font-size: 12px;
          line-height: 10px;
        }
        

        /* Text span with hanging indent:
           first line starts after checkbox,
           wrapped lines align under text, NOT under checkbox */
           
        .challenge-text {
          display: block;
          display: block;
          word-wrap: break-word;
          max-width: 100%;
          user-select: none;
        }


        /* Optional: styling for challenge description */
        .challenge-desc {
          margin-left: 22px; /* indent to align with text */
          font-size: 1rem;
          color: #999999;
          padding-bottom: 7px;
          white-space: pre-wrap;  /* Preserve 
 line breaks and wrap long lines */
          line-height: 1.2;  /* smaller numbers = tighter spacing */
        }
        
        .thin-divider {
          border: none;
          border-top: 1px solid #444;
          /*width: 825px;    Allowing this will kill the word-wrap and dynamic resizing of the general challenges*/
          max-width: 100%;
          margin: 8px auto;
        }


    
        .role-heading {
            font-family: 'RDOFont', sans-serif;  /* Example font, change as needed */
            font-size: 1.5rem;
            color: #eee;
            margin: -4px 0 0 0;
            
            text-shadow:
            -3px -3px 0 #000,  
             3px -3px 0 #000,
            -3px 3px 0 #000,
             3px 3px 0 #000;
             text-shadow: 1px 1px 2px rgba(0,0,0,0.6);
            letter-spacing: 0.05em; /* Adjust this value to your liking */
            padding-left: 20px; /* Increase this to move the text right */
            background-color: transparent;
            overflow: visible;
            /*Adding picture behind the heading text*/
            z-index: 0; /* Create a stacking context */
            background-image: url('HTML/images/RDO_Role_Challenges_Header3.png');
            background-repeat: no-repeat;
            background-position: 2px center;
            background-size: 410px 35px;
            
            display: flex;
            justify-content: space-between;
            align-items: center;
    
        }
            /* Space between different role challenges */
            .role-challenge {
              margin-bottom: .6rem; /* adjust as needed */
            }

        .role-challenge-text {
            font-family: 'hapna', sans-serif; /* Example font */
            font-size: 1.05rem;
            color: #eee;
            display: inline-block; /* keeps it inline for natural text flow */
            line-height: 1.1;
            display: inline;
            transform: scaleY(1.1); /* Increase font height */


        }
        .role-challenge-desc {
            font-family: 'hapna', sans-serif; /* Example font */
            font-size: 1rem;
            color: #aaa;
            margin-left: 6px; /* aligns under the role challenge text */
            white-space: pre-wrap; /* allows 
 line breaks in descriptions */
            transform: scaleX(0.925); /* reduce width to 90% */
        }
        
        /*  ##### Role Challenges Tickboxes ##### */
        
        /* Unchecked state */
        .role-challenge input[type="checkbox"] {
            width: 14px;
            height: 14px;
            margin: 0;
            margin-top: 0px;  /* Optional: better vertical alignment */
            appearance: none; /* Remove default styling */
            -webkit-appearance: none;
            background-color: #888; /* Default background */
            border: 2px solid #333;
            border-radius: 3px;
            cursor: pointer;
        }
        
        /* Checked state */
        .role-challenge input[type="checkbox"]:checked {
            background-color: #222;
            background-color: #b00000;  /* Dark Red Colour */
            border: 2px solid #333;
            border-radius: 3px;
        }
        .role-challenge input[type="checkbox"]:checked::before {
            content: "✔";
            display: block;
            text-align: center;
            color: white;
            font-size: 12px;
            line-height: 14px;
            vertical-align: middle;
            position: relative;
            top: -2px; /* Adjust this value to fine-tune the vertical alignment */
        }
        
        
        .role-challenge-label {
          display: flex;
          align-items: baseline; /* aligns checkbox with first line of text */
          gap: 0.5em;               /* space between checkbox and text */
          cursor: pointer;
          user-select: none;
          -webkit-user-select: none; /* Safari */
          -moz-user-select: none; /* Firefox */
          -ms-user-select: none; /* IE/Edge */
          
        }
        
        /* Using this to scale role challenge text */
        .text-scale {
            display: inline-block;
            transform: scaleX(0.9);
            transform-origin: left;
        }
        
        /* Makes it clickable */
        .difficulty-toggle {
            cursor: pointer;
            user-select: none;
            font-size: 0.6em;  /* adjust if needed */
            margin-right: 10px; /* adjust px as you like */
            color: #dd0000;  /* Dark Red Colour */
            transform: scaleY(1.2); 
            /* Mid-grey outline effect */
            text-shadow:
              -1px -1px 0 #111111,
               1px -1px 0 #111111,
              -1px  1px 0 #111111,
               1px  1px 0 #111111;
            }
        
        /* Dimming the difficulty-toggle */
        .dimmed-text {
            opacity: 0.5;
            pointer-events: none;
            user-select: none;
        }


        
        

/* ==== Checkbox Challenge Completion Styling ==== */


        /* When checkbox is checked, style the following sibling text */
        .challenge-checkbox:checked + .challenge-text,
        .challenge-checkbox:checked + .role-challenge-text {
          color: #555;
          text-decoration: line-through;
          opacity: 0.5;
        }


        /* This dims both the challenge text and the description when the challenge is completed */
        .challenge.completed .challenge-text,
        .challenge.completed .challenge-desc,
        .role-challenge.completed .role-challenge-text,
        .role-challenge.completed .role-challenge-desc {
          color: #555 !important;
          /* Uncomment if you want strikethrough and opacity effect */
          text-decoration: line-through;
          opacity: 0.85;
        }
        
        
        .role-completed {
          color: #555;
          font-weight: bold;
        }


        /* Dim role challenges and headings when all 9 role challenges are completed */
        .role-completed .role-challenge-text,
        .role-completed .role-heading {
          opacity: 0.5; /* dim text and headings */
          color: #666;  /* optional dim color */
          transition: opacity 0.3s ease;
          background: orange;
        }

        /* Keep checkboxes fully visible and interactive */
        .role-completed .challenge-checkbox {
          opacity: 1 !important;
          pointer-events: auto;
        }


        .role-challenge-desc.dimmed {
          opacity: 0.5;
          color: #666666;
          transition: opacity 0.3s ease, color 0.3s ease;
        }



/* ==== Global Checkbox Role Challenge Completion Styling (9 out of 9)==== */

        /* Per role heading dim */
        .role-heading.dimmed {
          color: #888;
          opacity: 0.6;
          transition: color 0.3s, opacity 0.3s;
        }

        /* Global dim of all role headings and challenge texts */
        .all-roles-completed .role-heading,
        .all-roles-completed .role-challenge-label span {
          color: #888;
          opacity: 0.5;
          transition: color 0.3s, opacity 0.3s;
        }
        
        .challenge-description.dimmed,
        .role-challenge p.dimmed {
            opacity: 0.5;
            color: #888888;  /* mid grey */
            transition: opacity 0.3s ease, color 0.3s ease;
        }

        /* But keep checkboxes fully visible and interactive */
        .all-roles-completed input[type="checkbox"] {
          opacity: 1 !important;
          pointer-events: auto;
        }
        
    /*############ RDO-CLOCK SECTION ############*/        
        .rdo-clock {
            position: absolute;
            bottom: 5px;  /* Position near the bottom of the banner */
            left: 47.5%;
            transform: translateX(-50%);
            transform: translateY(-2px);  /* Negative value moves it up */
            font-family: 'RDOFont', sans-serif;
            font-size: calc(1.5vw + 0.8rem);
            color: #white;
            text-shadow:
             -4px -4px 4px #cf0202,
              4px -4px 4px #cf0202,
             -4px  4px 4px #cf0202,
              4px  4px 4px #cf0202;
        }
        
        .rdo-clock.night-glow {
            text-shadow:
            -4px -4px 4px #0d2542,
             4px -4px 4px #0d2542,
            -4px  4px 4px #0d2542,
             4px  4px 4px #0d2542;
            /*color: #white;               Optional: change text color too */
}



    /*############ API CREDIT SECTION ############*/
        .api-credit-separator {
            border: none;
            height: 15px;               /* Thickness of the line */
            background-color: black;
            margin: 10px -15px;         /* Vertical spacing, and negative horizontal to counter the container padding so it stretches all the way across */
        }


        /* API credit styling */
        .api-credit {
          margin-top: auto;
          margin-bottom: 0px;
          padding: 0px 0 0px 5px;
          font-size: 0.75rem;
          color: #5b5b5b;
          font-family: Arial, sans-serif;
          text-align: right;
          line-height: 1
        }
        .api-credit a {
          color: #5b5b5b;
          text-decoration: none;
        }
        .api-credit a:hover {
          text-decoration: underline;
          color: #8e7878;
        }
        
        
     /*############ PAUSE RDR BUTTON SECTION ############*/       
        .pause-rdr2-button {
            position: absolute;
            top: 12px;
            left: 12px;
            z-index: 9999;
            padding: 6px 10px;
            background-color: #b00000;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 0.9rem;
            cursor: pointer;
            font-family: 'hapna', sans-serif;
            box-shadow: 1px 1px 3px rgba(0,0,0,0.4);
            transition: background-color 0.3s ease;
        }
        .pause-rdr2-button:hover {
            background-color: #900000;
        }
        
        #pauseBtn {
          position: absolute;
          top: 5px;
          right: 10px;
          width: 100px;
          cursor: pointer;
          display: none;    /* hidden by default */
          filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.6));
        }
        
        #pauseBtn:hover {
          filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.8));
          transform: scale(1.05);
        }
        
    </style>
</head>
<body>
    <div class="main-container">
        <div class="left-column">
            <div class="banner-container">
                <div class="banner-image-wrapper">
                    <img src="HTML/images/RDO_Banner_Wide.jpg" alt="Banner" class="banner-image"/>
                    <img id="pauseBtn" src="HTML/images/RDO_PauseStopwatch.png" alt="Pause RDO" title="Pause RDO"
                         style="position:absolute; top:0px; left:10px; width:50px; cursor:pointer;" />                    
                    <div class="banner-text-overlay">
                        <h1 class="banner-title">Daily Challenges</h1>
                        <div class="banner-date">Sunday, 2nd November 2025</div>
                    </div>
                    <div class="challenge-counters">
                        <div>General Challenges <span id="general-counter">(0/7)</span></div>
                        <div>Role Challenges <span id="role-counter">(0/9)</span></div>
                    </div>
                    <div class="rdo-clock" id="rdo-clock">
                        --:--
                    </div>
                </div>
            </div>

            <div class="general-challenges-container">
                
        <div class="challenge" data-difficulty="None">
          <label>
            <input type="checkbox" class="challenge-checkbox" id="challenge_2025-11-02_105330b908d873ac" />
            <span class="challenge-text">Finish a mode in Featured Series</span>
          </label></div>
<hr class="thin-divider">

        <div class="challenge" data-difficulty="None">
          <label>
            <input type="checkbox" class="challenge-checkbox" id="challenge_2025-11-02_9ec9be53793fc90c" />
            <span class="challenge-text">2 Free Roam Events played</span>
          </label></div>
<hr class="thin-divider">

        <div class="challenge" data-difficulty="None">
          <label>
            <input type="checkbox" class="challenge-checkbox" id="challenge_2025-11-02_a4187247c8260904" />
            <span class="challenge-text">3 Items sold to a Fence</span>
          </label>
          <div class="challenge-desc">Emerald Ranch, Rhodes, Thieves Landing, Van Horn and Saint Denis market all have a Fence.</div></div>
<hr class="thin-divider">

        <div class="challenge" data-difficulty="None">
          <label>
            <input type="checkbox" class="challenge-checkbox" id="challenge_2025-11-02_6fea4862ae63c35d" />
            <span class="challenge-text">Northern Pike caught</span>
          </label>
          <div class="challenge-desc">Try Cattail Pond, or the Dakota River between Fort Wallace and Valentine.</div></div>
<hr class="thin-divider">

        <div class="challenge" data-difficulty="None">
          <label>
            <input type="checkbox" class="challenge-checkbox" id="challenge_2025-11-02_3f44d82b7e4bf3cf" />
            <span class="challenge-text">5 Oleander Sage picked</span>
          </label>
          <div class="challenge-desc">Go to Rhodes then head to Shady Belle, and to the northeast of the mansion, just past the tiny jetty you'll find a number of Oleander Sage plants under the trees, should be five of them there.</div></div>
<hr class="thin-divider">

        <div class="challenge" data-difficulty="None">
          <label>
            <input type="checkbox" class="challenge-checkbox" id="challenge_2025-11-02_ce5bba278a38442c" />
            <span class="challenge-text">Visited a shop in Strawberry</span>
          </label></div>
<hr class="thin-divider">

        <div class="challenge" data-difficulty="None">
          <label>
            <input type="checkbox" class="challenge-checkbox" id="challenge_2025-11-02_8c0d4fd25a4501be" />
            <span class="challenge-text">3 Wolves killed</span>
          </label>
          <div class="challenge-desc">Wolves often attack between Fort Riggs and Riggs Station. Try Tall Trees, east of Aurora Basin.
Above MacFarlane's Ranch on the road to Harriet's, or by the railway south-east of the ranch.
Cumberland Forest can be a good location. Generally wolves tend to be out at night.</div></div>

            </div>
        </div>

<!-- COLUMN 2: ROLE CHALLENGES -->
        <div class="sidebar-container" id="roles-container">
            <div class="role-container">
  <h3 class="role-heading" id="role-bounty-hunter">Bounty Hunter&nbsp; <span class="difficulty-toggle RDOFont" data-difficulty="hard">(Hard: Rank 15+)</span></h3>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_4233f47eefc044ce" />
            <span class="role-challenge-text">1 Bounties brought in from New Hanover posters</span>
          </label>
          <div class="role-challenge-desc">Valentine, Emerald Station, Van Horn and Annesburg</div></div>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_9058360075f51103" />
            <span class="role-challenge-text">1 Bounty targets lassoed from horseback</span>
          </label>
          <div class="role-challenge-desc">Lasso the same target three times.</div></div>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_460bb7e7b36775a8" />
            <span class="role-challenge-text">1 More than one bounty target brought in at once</span>
          </label></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_0bf25948d102ca7d" />
            <span class="role-challenge-text">2 Bounties brought in from New Austin posters</span>
          </label>
          <div class="role-challenge-desc">Armadillo, Tumbleweed and Benedict Point</div></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_edd0762d5fecf97f" />
            <span class="role-challenge-text">2 Bounties completed within one real-world hour</span>
          </label></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_83cd663bb9ac7aa7" />
            <span class="role-challenge-text">Bounty completed without killing an enemy or bounty target</span>
          </label>
          <div class="role-challenge-desc">Risky, usually bugged and won't register</div></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_884a3c9ac86610de" />
            <span class="role-challenge-text">2 Bounty completed with at least one other Posse Member</span>
          </label></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_83cd663bb9ac7aa7" />
            <span class="role-challenge-text">Bounty completed without killing an enemy or bounty target</span>
          </label>
          <div class="role-challenge-desc">Risky, usually bugged and won't register</div></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_4d1b4a5176eaec8f" />
            <span class="role-challenge-text">3 Bounty targets brought in</span>
          </label></div>
</div>
<hr class="thin-divider" />
<div class="role-container">
  <h3 class="role-heading" id="role-trader">Trader&nbsp; <span class="difficulty-toggle RDOFont" data-difficulty="hard">(Hard: Rank 15+)</span></h3>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_ad26031174779a0b" />
            <span class="role-challenge-text">5280 Distance Delivery Wagon traveled on mission</span>
          </label>
          <div class="role-challenge-desc">Use a Change Appearance solo lobby so it registers</div></div>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_b512f6595eae9a32" />
            <span class="role-challenge-text">$50.00 Money made from trading</span>
          </label></div>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_ca28dcbb25fc64e7" />
            <span class="role-challenge-text">1 Resupply completed with 3 mins left</span>
          </label></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_04b4bb74b06bffc6" />
            <span class="role-challenge-text">10559 Distance Delivery Wagon traveled on mission</span>
          </label>
          <div class="role-challenge-desc">Use a Change Appearance solo lobby so it registers</div></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_73fcf139b8fc40c3" />
            <span class="role-challenge-text">2 Goods sold to local buyer</span>
          </label></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_117475bd85ffba3c" />
            <span class="role-challenge-text">4 Perfect carcasses donated to Cripps</span>
          </label>
          <div class="role-challenge-desc">Perfect pelts don't count. Try Emerald Ranch sheep.</div></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_17eb7ba375c36585" />
            <span class="role-challenge-text">3 Camp Stews eaten</span>
          </label></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_3de860b9058453d1" />
            <span class="role-challenge-text">3 Donated deadly predator carcass or skin</span>
          </label></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_3b59724647115f0a" />
            <span class="role-challenge-text">$200.00 Money made from trading</span>
          </label></div>
</div>
<hr class="thin-divider" />
<div class="role-container">
  <h3 class="role-heading" id="role-collector">Collector&nbsp; <span class="difficulty-toggle RDOFont" data-difficulty="hard">(Hard: Rank 15+)</span></h3>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_af78eab5de3bd9a2" />
            <span class="role-challenge-text">1 American Wild Flowers found</span>
          </label></div>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_ae9a1be38d2bdd62" />
            <span class="role-challenge-text">1 Antique Alcohol Bottles found</span>
          </label></div>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_0f439d76db88f688" />
            <span class="role-challenge-text">2 Collectibles collected</span>
          </label></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_1380002badf743ef" />
            <span class="role-challenge-text">2 Arrowheads found</span>
          </label></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_a7dbe46321a815cf" />
            <span class="role-challenge-text">3 Bird Eggs found</span>
          </label>
          <div class="role-challenge-desc">Keep less than 5 duck eggs in your satchel, and you can then pick 5 of them at once</div></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_7f6e662324122c98" />
            <span class="role-challenge-text">4 Collectibles collected</span>
          </label></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_7412647babd68c64" />
            <span class="role-challenge-text">3 Arrowheads found</span>
          </label></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_7cbb4f59e33c458c" />
            <span class="role-challenge-text">2 Collectibles found with a Metal Detector</span>
          </label></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_97b28daff39dbff5" />
            <span class="role-challenge-text">3 Collector Maps used</span>
          </label></div>
</div>
<hr class="thin-divider" />
<div class="role-container">
  <h3 class="role-heading" id="role-moonshiner">Moonshiner&nbsp; <span class="difficulty-toggle RDOFont" data-difficulty="hard">(Hard: Rank 15+)</span></h3>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_fb6dc36349dc79c9" />
            <span class="role-challenge-text">$50.00 Money made from moonshine sold</span>
          </label></div>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_f6ab0cbde3ffe0f2" />
            <span class="role-challenge-text">Moonshine of any type sold to a buyer</span>
          </label></div>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_e80f66ee60aa8aee" />
            <span class="role-challenge-text">Moonshine sold with 3 mins left</span>
          </label></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_0a71c46eada42c8f" />
            <span class="role-challenge-text">Crafted Toxic Moonshine</span>
          </label></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_bc42d8f8821a9c52" />
            <span class="role-challenge-text">1 Moonshine Bar - Drunken player interaction</span>
          </label>
          <div class="role-challenge-desc">If solo, use Y then B button combo as entering shack</div></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_8f895dc71bc9e233" />
            <span class="role-challenge-text">1 Moonshine Story Mission completed</span>
          </label></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_e038419111804667" />
            <span class="role-challenge-text">4827 Distance Moonshine Wagon traveled on mission</span>
          </label></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_13b5b3aede9acffc" />
            <span class="role-challenge-text">3 Moonshine Bootlegger Missions completed</span>
          </label></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_0f4883a6fe3ffe92" />
            <span class="role-challenge-text">2 Played with a band for 2 mins</span>
          </label></div>
</div>
<hr class="thin-divider" />
<div class="role-container">
  <h3 class="role-heading" id="role-naturalist">Naturalist&nbsp; <span class="difficulty-toggle RDOFont" data-difficulty="hard">(Hard: Rank 15+)</span></h3>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_a04f5ec0bd736c6b" />
            <span class="role-challenge-text">1 Blending Tonics crafted or used</span>
          </label></div>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_cf51af02d7363d67" />
            <span class="role-challenge-text">Don't kill an animal for 12 game hours</span>
          </label></div>

        <div class="role-challenge" data-difficulty="easy">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_284a4be7f5835d48" />
            <span class="role-challenge-text">1 Legendary Animals photographed</span>
          </label></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_a04f5ec0bd736c6b" />
            <span class="role-challenge-text">1 Blending Tonics crafted or used</span>
          </label></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_f85c94c66f41aaf4" />
            <span class="role-challenge-text">1 Legendary Animals found using pheromones</span>
          </label></div>

        <div class="role-challenge" data-difficulty="med">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_f9c3c5a2a3a7658a" />
            <span class="role-challenge-text">1 Sedated animals revived</span>
          </label></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_c36d02f902de2cbc" />
            <span class="role-challenge-text">Don't kill an animal for 24 game hours</span>
          </label></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_9a50d23e61c79c00" />
            <span class="role-challenge-text">2 Legendary Animals found using pheromones</span>
          </label></div>

        <div class="role-challenge" data-difficulty="hard">
          <label class="role-challenge-label">
            <input type="checkbox" class="challenge-checkbox" id="role-challenge_2025-11-02_284a4be7f5835d48" />
            <span class="role-challenge-text">1 Legendary Animals photographed</span>
          </label></div>
</div>

            
            <hr class="api-credit-separator" />
            
            <div class="api-credit">
                <span class="api-label">Data provided by:&nbsp;</span>
                <a href="https://rdo.gg/api" target="_blank" class="api-link">rdo.gg API</a>
            </div>
        </div>

<!-- COLUMN 3: BONUS INFO (Now the final column, cleared of content) -->
        <div class="bonus-container" id="bonus-container">
            <h3 class="stats-heading" style="color: #666666;">Bonus Info</h3>
            

            <div style="padding: 2px; border: 1px solid #000; border-radius: 8px; background-color: #151515; text-align: left; color: #E0E0E0; font-family: sans-serif;">
                <!-- Original Daily Challenge Streak for context -->
                <p class="stats-text" style="margin-bottom: 2px; display: flex; justify-content: space-between; width: 100%;">
                    <span style="font-weight: 500; flex-basis: 70%;">Daily Challenge Streak:</span>
                    <!-- Changed from font-weight: bold; to color: #FFC107; -->
                    <span id="current-streak" style="color: #FFC107; text-align: right; flex-basis: 30%;">13 Days</span>
                </p>

                <!-- New Gold Per Challenge Stat -->
                <p class="stats-text" style="margin-bottom: 2px; display: flex; justify-content: space-between; width: 100%;">
                    <span style="font-weight: 500; flex-basis: 70%;">Gold Per Challenge:</span>
                    <!-- Changed from font-weight: bold; to color: #FFC107; -->
                    <span id="gold-per-challenge" style="color: #FFC107; text-align: right; flex-basis: 30%;">0.00 Gold Bars</span>
                </p>
                
                <!-- Completion Reward based on General or Role Challenges -->
                <p class="stats-text" style="margin-bottom: 2px; display: flex; justify-content: space-between; width: 100%;">
                    <span style="font-weight: 500; flex-basis: 70%;">Completion Reward:</span>
                    <!-- This ID must be targeted by your JavaScript to dynamically update the gold value -->
                    <span id="completion-bonus-reward" style="color: #FFC107; text-align: right; flex-basis: 30%;">0.00 Gold Bars</span>
                </p>
                
            </div>


        <!-- END COLUMN 3 -->
    </div> 
  
  
<!-- Default Statcounter code for RDO_dailies - codedunky
https://codedunky.github.io/RDO_dailies/ -->
<script type="text/javascript">
var sc_project=13147326; 
var sc_invisible=1; 
var sc_security="51162dbd"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img
class="statcounter"
src="https://c.statcounter.com/13147326/0/51162dbd/1/"
alt="Web Analytics"
referrerPolicy="no-referrer-when-downgrade"></a></div></noscript>
<!-- End of Statcounter Code -->  
  
  
  


<script>
// ////////////////////////////////////////////////////////////////////////////////////// //
// JavaScript: Check if flask server is running and show or hide button accordingly       //
// ////////////////////////////////////////////////////////////////////////////////////// //

// Check if the server is running
fetch('http://127.0.0.1:6969/status')
    .then(response => {
      if (response.ok) {
        document.getElementById('pauseBtn').style.display = 'inline';
      } else {
        document.getElementById('pauseBtn').style.display = 'none';
      }
    })
    .catch(error => {
      // Server is unreachable
      document.getElementById('pauseBtn').style.display = 'none';
    });





// ////////////////////////////////////////////////////////////////////////////////////// //
// JavaScript: Resize text size dynamically based on container width for better accuracy  //
// ////////////////////////////////////////////////////////////////////////////////////// //

function resizeBannerText() {
    const container = document.querySelector('.banner-container');
    const title = document.querySelector('.banner-title');
    const date = document.querySelector('.banner-date');
    const counters = document.querySelector('.challenge-counters');
    const clock = document.getElementById('rdo-clock');

    if (!container) return;

    const containerWidth = container.offsetWidth;
    const minWidth = 400;
    const maxWidth = 850;

    const scale = Math.max(minWidth, Math.min(containerWidth, maxWidth)) / maxWidth;

    title.style.fontSize = (2.5 * scale) + 'rem';
    date.style.fontSize = (1.4 * scale) + 'rem';
    counters.style.fontSize = (1.25 * scale) + 'rem';
    
    if (clock) {
    // Let's match the clock font scaling to date's scale, maybe slightly bigger if you want
    clock.style.fontSize = (2 * scale) + 'rem';
    }
    
    
}

window.addEventListener('resize', resizeBannerText);
window.addEventListener('load', resizeBannerText);




// ////////////////////////////////////////////////////////////////////////////////////// //
// JavaScript: In-Game clock routine                                                      //
// ////////////////////////////////////////////////////////////////////////////////////// //

const offsetSeconds = -600;  // -10 minutes offset

function getInGameHour() {
    const now = new Date();
    const utcSeconds = now.getUTCHours() * 3600 + now.getUTCMinutes() * 60 + now.getUTCSeconds();

    // Game time calculation: 1 real second = 30 game seconds
    const gameSeconds = (utcSeconds * 30 + offsetSeconds) % 86400;

    const gameHours = Math.floor(gameSeconds / 3600);
    const gameMinutes = Math.floor((gameSeconds % 3600) / 60);

    return gameHours + gameMinutes / 60;
}

function updateRDOClock() {
    const hourFloat = getInGameHour();
    const gameHours = Math.floor(hourFloat).toString().padStart(2, '0');
    const gameMinutes = Math.floor((hourFloat % 1) * 60).toString().padStart(2, '0');

    document.getElementById("rdo-clock").textContent = `${gameHours}:${gameMinutes}`;
}


// ////////////////////////////////////////////////////////////////////////////////////// //
// JavaScript: Swap banner image between 10pm and 5am                                     //
// ////////////////////////////////////////////////////////////////////////////////////// //

function updateBanner() {
    const hour = getInGameHour();
    console.log("Current in-game hour:", hour);
    const banner = document.querySelector('.banner-image');

    if (hour >= 22 || hour < 5) {
        if (!banner.src.endsWith("RDO_Banner_Wide_Night.jpg")) {
            console.log("Switching to night banner");
            banner.src = "HTML/images/RDO_Banner_Wide_Night.jpg";
        }
    } else {
        if (!banner.src.endsWith("RDO_Banner_Wide.jpg")) {
            console.log("Switching to day banner");
            banner.src = "HTML/images/RDO_Banner_Wide.jpg";
        }
    }
}


// ////////////////////////////////////////////////////////////////////////////////////// //
// JavaScript: Change clock glow colour between 10pm and 5am                              //
// ////////////////////////////////////////////////////////////////////////////////////// //

function updateClockGlow() {
    const hour = getInGameHour();
    const clock = document.querySelector('.rdo-clock');

    if (hour >= 22 || hour < 5) {
        clock.classList.add('night-glow');
    } else {
        clock.classList.remove('night-glow');
    }
}


// ////////////////////////////////////////////////////////////////////////////////////// //
// JavaScript: Call various time related functions                                        //
// ////////////////////////////////////////////////////////////////////////////////////// //

function updateAllTimeFunctions() {
    updateRDOClock();
    updateBanner();
    updateClockGlow();
}

// Use a single interval to keep everything in sync
setInterval(updateAllTimeFunctions, 1000);
updateAllTimeFunctions();






// ////////////////////////////////////////////////////////////////////////////////////// //
// JavaScript: Main logic for toggling, persistence, counters, and difficulty switching  //
// ////////////////////////////////////////////////////////////////////////////////////// //

    const PYTHON_STREAK_OVERRIDE_STR = "{ manual_streak | default('0') }";
    const PYTHON_STREAK_OVERRIDE = parseInt(PYTHON_STREAK_OVERRIDE_STR, 10);
    

document.addEventListener("DOMContentLoaded", function() {

    // --- STREAK AND GOLD LOGIC CONSTANTS ---
    const LS_STREAK_COUNT = 'rdoStreakCount';
    const LS_LAST_COMPLETION_DATE = 'rdoLastCompletionDate';
    const LS_CHALLENGE_STATUS = 'rdoChallengeStatus';
    const LS_STREAK_FOR_MULTIPLIER = 'rdoStreakForMultiplier'; 
    const MAX_RDO_STREAK = 28; // Enforce the maximum visual and reward streak
    
    // --- ELEMENT SELECTORS (SCOPE FIX) ---
    const allCheckboxes = document.querySelectorAll('.challenge-checkbox');
    const generalCheckboxes = document.querySelectorAll('.challenge-checkbox[id^="challenge_"]');
    const roleCheckboxes = document.querySelectorAll('.challenge-checkbox[id^="role-challenge_"]');
    
    // --- Utility Functions ---

    function getRDODayKey() {
        const now = new Date();
        const resetTimeHours = 6; 
        const date = new Date(now.getTime());

        if (date.getUTCHours() < resetTimeHours) {
            date.setUTCDate(date.getUTCDate() - 1);
        }

        const year = date.getUTCFullYear();
        const month = String(date.getUTCMonth() + 1).padStart(2, '0');
        const day = String(date.getUTCDate()).padStart(2, '0');
        
        return year + "-" + month + "-" + day;
    }

    function getDateDifferenceInDays(dateStr1, dateStr2) {
        const date1 = new Date(dateStr1 + 'T12:00:00Z');
        const date2 = new Date(dateStr2 + 'T12:00:00Z');
        const diffTime = Math.abs(date2.getTime() - date1.getTime());
        const diffDays = Math.round(diffTime / (1000 * 60 * 60 * 24)); 
        return diffDays;
    }
    
    // --- Streak Storage and Calculation Functions ---

    /**
     * Updates LS_STREAK_COUNT and sets completion status.
     * CAPS the streak at MAX_RDO_STREAK.
     */
    function setStreakCount(newCount, setCompleted) {
        // FIX 1: Enforce Max Streak here
        const count = Math.min(Math.max(0, newCount), MAX_RDO_STREAK); 
        localStorage.setItem(LS_STREAK_COUNT, count);
        
        if (setCompleted) {
            localStorage.setItem(LS_LAST_COMPLETION_DATE, getRDODayKey());
            localStorage.setItem(LS_CHALLENGE_STATUS, 'completed');
        } else {
            localStorage.removeItem(LS_LAST_COMPLETION_DATE);
            localStorage.removeItem(LS_CHALLENGE_STATUS);
        }
    }

    function getMultiplier() { 
        const lockedStreak = parseInt(localStorage.getItem(LS_STREAK_FOR_MULTIPLIER) || '0', 10);
        
        if (lockedStreak >= 21) return 2.5;
        if (lockedStreak >= 14) return 2.0;
        if (lockedStreak >= 7) return 1.5;
        return 1.0; 
    }
    
    /**
     * Calculates the streak count that was achieved at the end of the *previous* RDO day, 
     * handling any streak breaks.
     */
    function getCurrentStreakBeforeToday() {
        let currentStreak = parseInt(localStorage.getItem(LS_STREAK_COUNT) || '0', 10);
        const lastCompletionDateStr = localStorage.getItem(LS_LAST_COMPLETION_DATE);
        const currentDayKey = getRDODayKey();
        
        if (lastCompletionDateStr) {
            const daysDifference = getDateDifferenceInDays(currentDayKey, lastCompletionDateStr);

            if (daysDifference > 1) {
                return 0;
            } 
        }
        
        return currentStreak;
    }

/**
     * Handles the streak logic based on a check/uncheck event.
     */
    function handleStreakUpdate(isTicked) {
        const completedGeneral = Array.from(generalCheckboxes).filter(cb => cb.checked).length;
        const completedRole = Array.from(roleCheckboxes).filter(cb => cb.checked).length;
        const challengesCompleted = completedGeneral + completedRole;
        const currentStatus = localStorage.getItem(LS_CHALLENGE_STATUS);
        
        // This is the streak value *before* today's first completion, guaranteed to be stable (e.g., 13)
        // by the 6 AM UTC lock rule, which we stored in loadStreak().
        const lockedStreakForMultiplier = parseInt(localStorage.getItem(LS_STREAK_FOR_MULTIPLIER) || '0', 10);
        
        // Read the currently saved streak (e.g., 14)
        const currentSavedStreak = parseInt(localStorage.getItem(LS_STREAK_COUNT) || '0', 10);

        // --- 1. FIRST TICK OF THE DAY (INCREMENT) ---
        // If a box is ticked, challenges are now > 0, and the status hasn't been set yet.
        if (isTicked && challengesCompleted > 0 && currentStatus !== 'completed') {
            
            // Increment is based on the guaranteed stable previous day's streak (lockedStreakForMultiplier)
            const newStreak = lockedStreakForMultiplier + 1;
            setStreakCount(newStreak, true); // Sets new streak, status, and date.
            
            console.log("Streak Incremented: " + newStreak);
            
        // --- 2. LAST UNTICK OF THE DAY (REVERT) ---
        // If all challenges are 0, AND the day was marked complete
        } else if (!isTicked && challengesCompleted === 0 && currentStatus === 'completed') {
            
            // CRITICAL CHECK: Only revert if the current streak has been incremented today.
            // i.e., currentSavedStreak (14) > lockedStreakForMultiplier (13)
            if (currentSavedStreak > lockedStreakForMultiplier) {
                
                // Set the streak directly back to the guaranteed previous day's value (e.g., 13)
                // setCompleted=false clears LS_CHALLENGE_STATUS and LS_LAST_COMPLETION_DATE
                setStreakCount(lockedStreakForMultiplier, false); 
                
                console.log("Streak Reverted from " + currentSavedStreak + " to " + lockedStreakForMultiplier);
            }

        } 
        
        // Always update the UI after the potential change
        updateCounters();
    }
    
    /**
     * Loads the streak from local storage, performs the break check, and sets the GOLD MULTIPLIER lock.
     */
    function loadStreak() {
        let currentStreak = parseInt(localStorage.getItem(LS_STREAK_COUNT) || '0', 10);
        const lastCompletionDateStr = localStorage.getItem(LS_LAST_COMPLETION_DATE);
        const currentDayKey = getRDODayKey();
        
        // --- PYTHON OVERRIDE CHECK ---
        if (PYTHON_STREAK_OVERRIDE > 0) {
            setStreakCount(PYTHON_STREAK_OVERRIDE, true); 
            currentStreak = PYTHON_STREAK_OVERRIDE; 
            localStorage.setItem(LS_STREAK_FOR_MULTIPLIER, currentStreak);
            console.log("OVERRIDE APPLIED. Streak: " + currentStreak + " Multiplier Locked."); 
        }
        
        // --- STREAK BREAK CHECK & MULTIPLIER LOCK ---
        if (lastCompletionDateStr) {
            const daysDifference = getDateDifferenceInDays(currentDayKey, lastCompletionDateStr);
            
            if (daysDifference > 1) {
                currentStreak = 0; 
                setStreakCount(0, false); 
                localStorage.setItem(LS_STREAK_FOR_MULTIPLIER, 0); 
                console.log("Streak Broken! Reset to 0 days.");
                
            } else if (daysDifference === 1) {
                // NEW DAY: Multiplier is locked to yesterday's streak (currentStreak holds yesterday's value).
                localStorage.setItem(LS_STREAK_FOR_MULTIPLIER, currentStreak);
                
                // Clear completion status keys to allow handleStreakUpdate to increment the streak.
                localStorage.removeItem(LS_CHALLENGE_STATUS);
                localStorage.removeItem(LS_LAST_COMPLETION_DATE); 
                
                console.log("New RDO Day. Multiplier locked to previous streak of " + currentStreak + " days.");
            }

        } else if (currentStreak > 0) {
             // First time user uses the tracker or after a manual reset. Lock multiplier to current streak.
            localStorage.setItem(LS_STREAK_FOR_MULTIPLIER, currentStreak);
        }

        // --- INITIAL UI DISPLAY ---
        const streakElement = document.getElementById('current-streak');
        const multiplierElement = document.getElementById('streak-multiplier');

        if (streakElement) {
            const multiplier = getMultiplier(); 
            streakElement.textContent = currentStreak + " Days";
            
            if (multiplierElement) {
                multiplierElement.textContent = multiplier.toFixed(1) + "x";
            }
            console.log("UI STREAK UPDATED. Streak: " + currentStreak + " Multiplier: " + multiplier.toFixed(1) + "x");
        }
    }

    function calculateDailyGoldTotal(completedGeneral, completedRole) {
        const BASE_REWARD = 0.10; 
        const COMPLETION_BONUS_BASE = 0.30; 
        const MAX_GENERAL = 7;
        const MAX_ROLE = 9;
        
        const multiplier = getMultiplier(); 

        const completionBonusAmount = COMPLETION_BONUS_BASE * multiplier;
        const generalChallengesGold = (completedGeneral * BASE_REWARD) * multiplier;
        const generalCompletionBonus = (completedGeneral === MAX_GENERAL) ? completionBonusAmount : 0;
        const roleChallengesGold = (completedRole * BASE_REWARD) * multiplier;
        const roleCompletionBonus = (completedRole === MAX_ROLE) ? completionBonusAmount : 0;
        const totalGold = generalChallengesGold + generalCompletionBonus + roleChallengesGold + roleCompletionBonus;
        
        // UI Update: Gold Per Challenge
        const goldPerChallengeElement = document.getElementById('gold-per-challenge');
        if (goldPerChallengeElement) {
            const singleChallengeGold = BASE_REWARD * multiplier; 
            goldPerChallengeElement.textContent = singleChallengeGold.toFixed(2) + " Gold Bars";
        }

        // UI Update: Completion Bonus element
        const completionBonusElement = document.getElementById('completion-bonus-reward');
        if (completionBonusElement) {
            const bonusRewardText = completionBonusAmount.toFixed(2) + " Gold Bars";
            completionBonusElement.textContent = bonusRewardText;
        }


        return totalGold.toFixed(2);
    }

    // --- STREAK AND GOLD LOGIC (END) ---
    
    // The index_mod_date_str is a simple string, no complex escaping needed here
    const currentVersion = "2025-11-02_11-32-27"; 
    const storedVersion = localStorage.getItem("challenge_version");

    if (storedVersion !== currentVersion) {
        Object.keys(localStorage).forEach(key => {
            if (key.startsWith("role-challenge_") || key.startsWith("challenge_")) {
                localStorage.removeItem(key);
            }
        });
        localStorage.setItem("challenge_version", currentVersion);
    }
    
    // Function to dim headings when all visible challenges for a role are completed
    function updateRoleHeadingCompletion() {
        document.querySelectorAll('.role-container').forEach(roleContainer => {
            const visibleChallenges = Array.from(roleContainer.querySelectorAll('.role-challenge')).filter(ch => ch.style.display !== 'none');
            const allCompleted = visibleChallenges.length > 0 && visibleChallenges.every(ch => {
                const cb = ch.querySelector('.challenge-checkbox');
                return cb && cb.checked;
            });

            const heading = roleContainer.querySelector('.role-heading');
            if (heading) {
                heading.classList.toggle('dimmed', allCompleted);
            }
        });
    }

    function updateCounters() {
        const generalDone = Array.from(generalCheckboxes).filter(cb => cb.checked).length;
        const generalTotal = generalCheckboxes.length;
        const roleDone = Math.min(
            Array.from(roleCheckboxes).filter(cb => {
                return cb.checked && cb.closest('.role-challenge')?.style.display !== 'none';
            }).length,
            9
        );
        const roleTotal = 9;

        // --- Update General and Role Counters ---
        const generalCounter = document.getElementById('general-counter');
        const roleCounter = document.getElementById('role-counter');

        if (generalCounter) {
            generalCounter.textContent = generalDone + "/" + generalTotal;
            generalCounter.classList.toggle('counter-glow', generalDone === generalTotal);
        }
        if (roleCounter) {
            roleCounter.textContent = roleDone + "/" + roleTotal;
            roleCounter.classList.toggle('counter-glow', roleDone === roleTotal);
        }
        
        // --- Update Streak UI (reflects the latest LS_STREAK_COUNT) ---
        const streakElement = document.getElementById('current-streak');
        if (streakElement) {
            const currentStreak = parseInt(localStorage.getItem(LS_STREAK_COUNT) || '0', 10);
            streakElement.textContent = currentStreak + " Days";
        }
        
        // --- Update Gold Totals ---
        const totalGold = calculateDailyGoldTotal(generalDone, roleDone);
        const goldDisplay = document.getElementById('daily-gold-total');

        if (goldDisplay) {
            goldDisplay.textContent = totalGold + " Gold Bars";
        }

        // --- Update Dims and Toggles ---
        const rolesContainer = document.getElementById('roles-container') || document.body;
        rolesContainer.classList.toggle('all-roles-completed', roleDone === roleTotal);
        roleCheckboxes.forEach(cb => {
            cb.disabled = (roleDone === roleTotal) && !cb.checked;
            const challenge = cb.closest('.role-challenge');
            if(challenge) challenge.classList.toggle('dimmed', (roleDone === roleTotal) && !cb.checked);
        });
        document.querySelectorAll('.difficulty-toggle').forEach(toggle => {
            toggle.disabled = roleDone === roleTotal;
            toggle.classList.toggle('dimmed-text', roleDone === roleTotal);
        });

        updateRoleHeadingCompletion();
    }
    
    // --- Initialize Streak (Must run before UI updates) ---
    loadStreak();

    allCheckboxes.forEach(cb => {
        const key = cb.id;
        const saved = localStorage.getItem(key);

        cb.checked = saved === "true";

        const wrapper = cb.closest('.challenge') || cb.closest('.role-challenge');
        if (cb.checked && wrapper) {
            wrapper.classList.add('completed');
        } else if (wrapper) {
            wrapper.classList.remove('completed');
        }

        cb.addEventListener('change', () => {
            if (wrapper) {
                wrapper.classList.toggle('completed', cb.checked);
            }
            localStorage.setItem(key, cb.checked);
            
            // CRITICAL: Call the unified handler for streak/multiplier updates
            handleStreakUpdate(cb.checked);
        });
    });

    // Difficulty toggle logic
    function updateRoleDifficulty(roleContainer, difficulty) {
        const challenges = roleContainer.querySelectorAll('.role-challenge');

        challenges.forEach(challenge => {
            const challengeDifficulty = challenge.getAttribute('data-difficulty') || 'easy';
            challenge.style.display = (challengeDifficulty === difficulty) ? '' : 'none';
        });

        const toggle = roleContainer.querySelector('.difficulty-toggle');
        if (toggle) {
            toggle.dataset.difficulty = difficulty;
            const desc = difficulty === 'easy' ? 'Rank 1–5'
                : difficulty === 'med' ? 'Rank 6–14'
                : 'Rank 15+';

            toggle.textContent = desc;
        }

        updateRoleHeadingCompletion();
    }

    function nextDifficulty(current) {
        if (current === 'easy') return 'med';
        if (current === 'med') return 'hard';
        return 'easy';
    }

    const toggles = document.querySelectorAll('.difficulty-toggle');

    toggles.forEach(toggle => {
        toggle.addEventListener('click', () => {
            const roleContainer = toggle.closest('.role-container');
            const currentDifficulty = toggle.dataset.difficulty || 'easy';
            const newDifficulty = nextDifficulty(currentDifficulty);
            updateRoleDifficulty(roleContainer, newDifficulty);
            updateCounters();
        });

        const roleContainer = toggle.closest('.role-container');
        updateRoleDifficulty(roleContainer, toggle.dataset.difficulty || 'easy');
    });

    // CRITICAL: Final call to update everything after loading all states.
    updateCounters();
});




// ////////////////////////////////////////////////////////////////////////////////////// //
// JavaScript: Pause Button Code                                                          //
// ////////////////////////////////////////////////////////////////////////////////////// //

document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('pauseBtn').addEventListener('click', () => {
      fetch('http://127.0.0.1:6969/pause', {
        method: 'POST'
      })
      .then(response => response.text())
      .then(data => alert('Server response: ' + data))
      .catch(error => alert('Error: ' + error));
    });
});



</script>















</body>
</html>
